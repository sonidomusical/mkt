<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Registro de Asistencia v4 (Móvil)</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
  :root {
    /* Paleta extraída de la imagen (Naranja / Ámbar) */
    --color-perfect: #ffa000; 
    --color-perfect-bg: #fff3e0; 
    --color-warning: #fb8c00; 
    --color-warning-bg: #fff8e1;
    --color-fail: #ef5350;    
    --color-fail-bg: #ffebee;
    --color-pendiente: #757575; 
    --color-pendiente-bg: #f5f5f5;
    
    --brand-color: var(--color-perfect); 
    --text-color: #333333;
    --background-color: #fcfcfc;
    --border-color: #eeeeee;
  }

  body {
    font-family: 'Poppins', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
    margin: 0;
    background-color: var(--background-color);
    color: var(--text-color);
    font-size: 16px;
  }
  .main-container {
    padding: 1rem;
  }

  /* --- Header Corregido --- */
  .header {
    background-color: var(--brand-color);
    color: white;
    /* Ajustado a 0.5rem según solicitud */
    padding: 0.5rem; 
    text-align: center;
    border-radius: 0 0 20px 20px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    /* Ajustado a 0 según solicitud */
    margin: 0; 
    display: flex;
    align-items: center;
    justify-content: center;
    min-height: 60px; 
  }
  .header h2 {
    margin: 0; 
    font-weight: 700;
    letter-spacing: 0.5px;
    line-height: 1.2;
    text-transform: uppercase;
  }
  
  /* --- Resumen Superior --- */
  .summary-section {
    display: flex;
    justify-content: space-around;
    background-color: white;
    /* Padding ajustado según solicitud */
    padding: 0.5rem 1rem 0.5rem; 
    border-radius: 12px;
    box-shadow: 0 6px 20px rgba(0,0,0,0.06);
    /* Margen superior eliminado según solicitud */
    margin-top: 0; 
    text-align: center;
  }
  .summary-item {
    flex-grow: 1;
  }
  .summary-item .day {
    font-size: 0.8rem;
    font-weight: 500;
    color: var(--color-pendiente);
    text-transform: uppercase;
  }
  .summary-item .count {
    font-size: 1rem;
    font-weight: 700;
    color: var(--brand-color);
  }

  /* --- Tabla Resumen General --- */
  .summary-table-container {
    background-color: white;
    padding: 1rem;
    border-radius: 12px;
    box-shadow: 0 6px 20px rgba(0,0,0,0.06);
    margin-top: 1rem;
  }
  .table-wrapper {
      overflow-x: auto;
  }
  .summary-table {
      width: 100%;
      border-collapse: collapse;
  }
  .summary-table th, .summary-table td {
      padding: 6px 8px;
      text-align: center;
      border-bottom: 1px solid var(--border-color);
      font-size: 0.9rem;
      vertical-align: middle;
  }
  .summary-table th {
      font-weight: 600;
      background-color: transparent;
      text-transform: uppercase;
      font-size: 0.7rem;
      color: var(--brand-color); 
      white-space: normal;
  }
  .summary-table td {
      text-align: center;
      color: #555;
  }
  .summary-table td:first-child {
      font-weight: 500;
  }
  .summary-table tbody tr:nth-child(even) {
      background-color: transparent;
  }
  .summary-table tbody tr:last-child td {
      border-bottom: none;
  }

  /* --- Resaltado de Filas --- */
  .row-highlight {
      background-color: var(--color-perfect-bg) !important;
  }
  .row-highlight td {
      color: var(--brand-color) !important;
      font-weight: 600 !important;
  }
  .row-highlight td:first-child {
      border-left: 4px solid var(--brand-color);
  }

  /* --- Diseño de Etiquetas de Estado --- */
  .status-tag {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    padding: 4px 12px;
    border-radius: 50em;
    font-weight: 600;
    font-size: 0.8rem;
  }
  .status-tag svg {
    width: 14px;
    height: 14px;
  }
  .tag-cumplido {
    color: var(--color-perfect);
    background-color: transparent;
  }
  .tag-cumplido svg {
    fill: var(--color-perfect);
  }
  .tag-incompleto {
    color: var(--color-pendiente);
    background-color: transparent; 
    font-weight: 400; 
    padding-left: 0;
    padding-right: 0;
  }
  .tag-incompleto svg {
    fill: var(--color-pendiente);
    opacity: 0.6; 
  }

  /* --- Lista de Tarjetas --- */
  .attendance-list {
    margin-top: 1.5rem;
    display: grid;
    gap: 1rem;
  }
  .person-card {
    background-color: #ffffff;
    border-radius: 12px;
    box-shadow: 0 6px 20px rgba(0,0,0,0.06);
    padding: 1rem;
    transition: transform 0.2s ease, box-shadow 0.2s ease;
  }
  .person-card:hover {
      transform: translateY(-4px);
      box-shadow: 0 10px 25px rgba(0,0,0,0.08);
  }
  .card-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    border-bottom: 1px solid var(--border-color);
    padding-bottom: 0.75rem;
    margin-bottom: 0.75rem;
  }
  .person-name {
    font-weight: 600;
    font-size: 1.2rem;
    color: var(--brand-color);
  }
  .progress-container {
      display: flex;
      align-items: center;
  }
  .progress-bar-bg {
      width: 80px;
      background-color: #e9ecef;
      border-radius: 6px;
      overflow: hidden;
      height: 8px;
      margin-left: 8px;
  }
  .progress-bar {
      height: 100%;
      background-color: var(--brand-color);
      border-radius: 6px;
      transition: width 0.3s ease-in-out;
  }
  .percentage-text {
      font-weight: 600;
      font-size: 0.9rem;
  }

  .card-body {
    display: grid;
    gap: 0.75rem;
  }
  .attendance-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    background-color: #f8f9fa;
    padding: 0.5rem 1rem;
    border-radius: 8px;
  }
  .attendance-day {
      font-weight: 500;
      color: #495057;
  }
  .status-badge {
    border-radius: 12px;
    padding: 0.25rem 0.75rem;
    font-weight: 600;
    font-size: 0.8rem;
    width: 85px;
    text-align: center;
  }
  .status-perfect { 
    color: var(--color-perfect);
    background-color: var(--color-perfect-bg);
    border: 1px solid var(--color-perfect); 
  }
  .status-falta { 
    color: var(--color-fail);
    background-color: var(--color-fail-bg);
    border: 1px solid var(--color-fail);
  }
  .status-pendiente { 
    color: var(--color-pendiente);
    background-color: var(--color-pendiente-bg);
    border: none; 
  }
</style>
</head>
<body>

<div class="header">
  <h2>CULTO DE ORACIÓN - ENE 2026</h2>
</div>

<div class="main-container">
  <div id="summary-section" class="summary-section"></div>
  <div id="summary-table-container"></div>
  <div id="attendance-list" class="attendance-list"></div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const year = 2026;
    const month = 0; // Enero
    const names = ["JEA", "ART", "YHA", "CRI", "LEO", "KAR", "LUI", "JOS", "ERI", "KAT", "JUA", "HP", "JAI"];
    names.sort();

    let attendanceData = {
        '1': {},
        '8': { 'HP': 'presente', 'CRI': 'presente', 'JUA': 'presente' },
        '15': { 'CRI': 'presente', 'KAT': 'presente', 'JEA': 'presente' },
        '22': { 'JAI': 'presente', 'JUA': 'presente' },
        '29': {}
    };

    const summarySection = document.getElementById("summary-section");
    const summaryTableContainer = document.getElementById("summary-table-container");
    const attendanceList = document.getElementById("attendance-list");

    const statusText = { presente: 'Presente', falta: 'Fasta', pendiente: '-' };

    const icons = {
        cumplido: `<svg viewBox="0 0 24 24"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/></svg>`,
        noAsistio: `<svg viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>`
    };

    function getThursdaysInMonth(year, month) {
        const thursdays = [];
        const date = new Date(year, month, 1);
        while (date.getDay() !== 4) { date.setDate(date.getDate() + 1); }
        while (date.getMonth() === month) {
            thursdays.push(date.getDate());
            date.setDate(date.getDate() + 7);
        }
        return thursdays;
    }

    const thursdaysOfMonth = getThursdaysInMonth(year, month);

    function renderApp() {
        attendanceList.innerHTML = '';
        
        names.forEach(name => {
            const card = document.createElement('div');
            card.className = 'person-card';
            card.dataset.name = name;

            let cardBodyHTML = '';
            thursdaysOfMonth.forEach(day => {
                const dayStr = day.toString();
                if (!attendanceData[dayStr]) attendanceData[dayStr] = {};
                const status = attendanceData[dayStr][name] || 'pendiente';
                cardBodyHTML += `
                    <div class="attendance-item">
                        <span class="attendance-day">Jueves ${dayStr}</span>
                        <div class="status-badge status-${status.replace('presente', 'perfect')}" data-name="${name}" data-day="${dayStr}">
                            ${statusText[status]}
                        </div>
                    </div>
                `;
            });
            
            card.innerHTML = `
                <div class="card-header">
                    <span class="person-name">${name}</span>
                    <div class="progress-container">
                        <span class="percentage-text">0%</span>
                        <div class="progress-bar-bg">
                            <div class="progress-bar" style="width: 0%;"></div>
                        </div>
                    </div>
                </div>
                <div class="card-body">
                    ${cardBodyHTML}
                </div>
            `;
            
            attendanceList.appendChild(card);
            updatePersonSummary(name);
        });

        updateSummarySection();
        renderSummaryTable();
    }
    
    function updatePersonSummary(name) {
        let presentCount = 0;
        thursdaysOfMonth.forEach(day => {
            if (attendanceData[day.toString()] && attendanceData[day.toString()][name] === 'presente') {
                presentCount++;
            }
        });

        const asistenciaMinima = 1;
        const percentage = asistenciaMinima > 0 ? Math.round((presentCount / asistenciaMinima) * 100) : 0;
        const progressBarWidth = Math.min(percentage, 100);

        const card = attendanceList.querySelector(`.person-card[data-name="${name}"]`);
        if (card) {
            card.querySelector('.percentage-text').textContent = `${percentage}%`;
            card.querySelector('.progress-bar').style.width = `${progressBarWidth}%`;
        }
    }

    function updateSummarySection() {
        summarySection.innerHTML = '';
        thursdaysOfMonth.forEach(day => {
            const dayStr = day.toString();
            let presentCount = 0;
            if (attendanceData[dayStr]) {
                presentCount = Object.values(attendanceData[dayStr]).filter(s => s === 'presente').length;
            }

            const summaryItem = document.createElement('div');
            summaryItem.className = 'summary-item';
            summaryItem.innerHTML = `
                <div class="day">Jueves ${dayStr}</div>
                <div class="count">${presentCount}</div>
            `;
            summarySection.appendChild(summaryItem);
        });
    }

    function renderSummaryTable() {
        let tableHTML = `
            <div class="summary-table-container">
                <div class="table-wrapper">
                    <table class="summary-table">
                        <thead>
                            <tr>
                                <th>Nombre</th>
                                <th>Asistencia minima</th>
                                <th>días asistidos</th>
                                <th>% Asistencia</th>
                            </tr>
                        </thead>
                        <tbody>`;

        names.forEach(name => {
            let presentCount = 0;
            thursdaysOfMonth.forEach(day => {
                if (attendanceData[day.toString()] && attendanceData[day.toString()][name] === 'presente') {
                    presentCount++;
                }
            });
            
            const asistenciaMinima = 1;
            let statusClass, statusIcon, statusLabel;
            let isCumplido = false;

            if (presentCount >= asistenciaMinima) {
                statusClass = 'tag-cumplido';
                statusIcon = icons.cumplido;
                statusLabel = 'Cumplido';
                isCumplido = true;
            } else {
                statusClass = 'tag-incompleto';
                statusIcon = icons.noAsistio;
                statusLabel = 'No asistió';
            }

            const statusTagHTML = `
                <div class="status-tag ${statusClass}">
                    ${statusIcon}
                    <span>${statusLabel}</span>
                </div>
            `;

            const rowClass = isCumplido ? 'row-highlight' : '';

            tableHTML += `
                <tr class="${rowClass}">
                    <td>${name}</td>
                    <td>${asistenciaMinima}</td>
                    <td>${presentCount > 0 ? presentCount : ''}</td>
                    <td>${statusTagHTML}</td>
                </tr>
            `;
        });

        tableHTML += `</tbody></table></div></div>`;
        summaryTableContainer.innerHTML = tableHTML;
    }

    renderApp();
});
</script>

</body>
</html>
