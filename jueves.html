<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Registro de Asistencia v4 (Móvil)</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
  :root {
    --color-presente: #28a745;
    --color-presente-bg: #e9f5ea;
    --color-falta: #dc3545;
    --color-falta-bg: #fbeaea;
    --color-pendiente: #6c757d;
    --color-pendiente-bg: #f8f9fa;
    --brand-color: #343a40;
    --text-color: #212529;
    --background-color: #f4f7f9;
    --border-color: #e9ecef;
  }

  body {
    font-family: 'Poppins', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
    margin: 0;
    background-color: var(--background-color);
    color: var(--text-color);
    font-size: 16px;
  }
  .main-container {
    padding: 1rem;
  }
  .header {
    background-color: var(--brand-color);
    color: white;
    padding: 1.5rem 1rem;
    text-align: center;
    border-radius: 0 0 20px 20px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    margin: -1rem -1rem 0 -1rem; /* Extend to screen edges */
  }
  .header h2 {
    margin: 0;
    font-weight: 700;
  }
  .header p {
    margin: 0.25rem 0 0;
    opacity: 0.9;
    font-weight: 400;
  }
  
  /* --- Resumen Superior --- */
  .summary-section {
    display: flex;
    justify-content: space-around;
    background-color: white;
    padding: 1rem;
    border-radius: 12px;
    box-shadow: 0 6px 20px rgba(0,0,0,0.06);
    margin-top: 1.5rem;
    text-align: center;
  }
  .summary-item {
    flex-grow: 1;
  }
  .summary-item .day {
    font-size: 0.8rem;
    font-weight: 500;
    color: var(--color-pendiente);
    text-transform: uppercase;
  }
  .summary-item .count {
    font-size: 1.75rem;
    font-weight: 700;
    color: var(--brand-color);
  }

  /* --- Lista de Tarjetas de Asistencia --- */
  .attendance-list {
    margin-top: 1.5rem;
    display: grid;
    gap: 1rem;
  }
  .person-card {
    background-color: #ffffff;
    border-radius: 12px;
    box-shadow: 0 6px 20px rgba(0,0,0,0.06);
    padding: 1rem;
    transition: transform 0.2s ease, box-shadow 0.2s ease;
  }
  .person-card:hover {
      transform: translateY(-4px);
      box-shadow: 0 10px 25px rgba(0,0,0,0.08);
  }
  .card-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    border-bottom: 1px solid var(--border-color);
    padding-bottom: 0.75rem;
    margin-bottom: 0.75rem;
  }
  .person-name {
    font-weight: 600;
    font-size: 1.2rem;
    color: var(--brand-color);
  }
  .progress-container {
      display: flex;
      align-items: center;
  }
  .progress-bar-bg {
      width: 80px;
      background-color: #e9ecef;
      border-radius: 6px;
      overflow: hidden;
      height: 8px;
      margin-left: 8px;
  }
  .progress-bar {
      height: 100%;
      background-color: var(--brand-color);
      border-radius: 6px;
      transition: width 0.3s ease-in-out;
  }
  .percentage-text {
      font-weight: 600;
      font-size: 0.9rem;
  }

  .card-body {
    display: grid;
    gap: 0.75rem;
  }
  .attendance-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    background-color: #f8f9fa;
    padding: 0.5rem 1rem;
    border-radius: 8px;
  }
  .attendance-day {
      font-weight: 500;
      color: #495057;
  }
  .status-badge {
    border-radius: 12px;
    padding: 0.25rem 0.75rem;
    font-weight: 600;
    font-size: 0.8rem;
    cursor: pointer;
    width: 85px;
    text-align: center;
  }
  .status-presente { color: var(--color-presente); background-color: var(--color-presente-bg); border: 1px solid var(--color-presente);}
  .status-falta { color: var(--color-falta); background-color: var(--color-falta-bg); border: 1px solid var(--color-falta);}
  .status-pendiente { color: var(--color-pendiente); background-color: var(--color-pendiente-bg); border: 1px solid #ced4da;}

</style>
</head>
<body>

<div class="header">
  <h2>CULTOS DE ORACIÓN</h2>
  <p>Asistencia - Setiembre 2025</p>
</div>

<div class="main-container">
  <div id="summary-section" class="summary-section">
    <!-- Resumen se generará aquí -->
  </div>
  <div id="attendance-list" class="attendance-list">
    <!-- Tarjetas de personas se generarán aquí -->
  </div>
</div>


<script>
document.addEventListener('DOMContentLoaded', function() {
    const year = 2025;
    const month = 8;
    const names = ["JEA", "ART", "YHA", "CRI", "LEO", "KAR", "LUI", "JOS", "ERI", "KAT", "JUA", "HP", "JAI"];
    names.sort();

    let attendanceData = {
        '11': { 'CRI': 'presente', 'JAI': 'presente' },
        '18': { 'HP': 'presente', 'JAI': 'presente', 'LEO': 'presente', 'YHA': 'presente' },
        '25': { 'JUA': 'presente', 'HP': 'presente', 'JAI': 'falta' }
    };

    const summarySection = document.getElementById("summary-section");
    const attendanceList = document.getElementById("attendance-list");

    const statusText = { presente: 'Presente', falta: 'Falta', pendiente: 'Pendiente' };
    const statusCycle = ['pendiente', 'presente', 'falta'];

    function getThursdaysInMonth(year, month) {
        const thursdays = [];
        const date = new Date(year, month, 1);
        while (date.getDay() !== 4) { date.setDate(date.getDate() + 1); }
        while (date.getMonth() === month) {
            thursdays.push(date.getDate());
            date.setDate(date.getDate() + 7);
        }
        return thursdays;
    }

    const thursdaysOfMonth = getThursdaysInMonth(year, month);

    function renderApp() {
        attendanceList.innerHTML = ''; // Limpiar lista
        
        names.forEach(name => {
            const card = document.createElement('div');
            card.className = 'person-card';
            card.dataset.name = name;

            let cardBodyHTML = '';
            thursdaysOfMonth.forEach(day => {
                const dayStr = day.toString();
                if (!attendanceData[dayStr]) attendanceData[dayStr] = {};
                const status = attendanceData[dayStr][name] || 'pendiente';
                cardBodyHTML += `
                    <div class="attendance-item">
                        <span class="attendance-day">Jueves ${dayStr}</span>
                        <div class="status-badge status-${status}" data-name="${name}" data-day="${dayStr}">
                            ${statusText[status]}
                        </div>
                    </div>
                `;
            });
            
            card.innerHTML = `
                <div class="card-header">
                    <span class="person-name">${name}</span>
                    <div class="progress-container">
                        <span class="percentage-text">0%</span>
                        <div class="progress-bar-bg">
                            <div class="progress-bar" style="width: 0%;"></div>
                        </div>
                    </div>
                </div>
                <div class="card-body">
                    ${cardBodyHTML}
                </div>
            `;
            
            attendanceList.appendChild(card);
            updatePersonSummary(name);
        });

        // Add event listeners after rendering all cards
        document.querySelectorAll('.status-badge').forEach(badge => {
            badge.addEventListener('click', toggleStatus);
        });

        updateSummarySection();
    }
    
    function toggleStatus(event) {
        const { name, day } = event.currentTarget.dataset;
        const currentStatus = attendanceData[day][name] || 'pendiente';
        const currentIndex = statusCycle.indexOf(currentStatus);
        const nextStatus = statusCycle[(currentIndex + 1) % statusCycle.length];
        
        attendanceData[day][name] = nextStatus;
        
        const badge = event.currentTarget;
        badge.className = `status-badge status-${nextStatus}`;
        badge.textContent = statusText[nextStatus];
        
        updateSummarySection();
        updatePersonSummary(name);
    }
    
    function updatePersonSummary(name) {
        const totalDays = thursdaysOfMonth.length;
        if (totalDays === 0) return;

        let presentCount = 0;
        thursdaysOfMonth.forEach(day => {
            if (attendanceData[day.toString()] && attendanceData[day.toString()][name] === 'presente') {
                presentCount++;
            }
        });

        const percentage = Math.round((presentCount / totalDays) * 100);
        const card = attendanceList.querySelector(`.person-card[data-name="${name}"]`);
        if (card) {
            card.querySelector('.percentage-text').textContent = `${percentage}%`;
            card.querySelector('.progress-bar').style.width = `${percentage}%`;
        }
    }

    function updateSummarySection() {
        summarySection.innerHTML = '';
        thursdaysOfMonth.forEach(day => {
            const dayStr = day.toString();
            let presentCount = 0;
            if (attendanceData[dayStr]) {
                presentCount = Object.values(attendanceData[dayStr]).filter(s => s === 'presente').length;
            }

            const summaryItem = document.createElement('div');
            summaryItem.className = 'summary-item';
            summaryItem.innerHTML = `
                <div class="day">Jueves ${dayStr}</div>
                <div class="count">${presentCount}</div>
            `;
            summarySection.appendChild(summaryItem);
        });
    }

    renderApp();
});
</script>

</body>
</html>

